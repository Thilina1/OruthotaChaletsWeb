(()=>{var e={};e.id=407,e.ids=[407],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13537:(e,t,r)=>{Promise.resolve().then(r.bind(r,50994))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37366:e=>{"use strict";e.exports=require("dns")},42355:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/thilinaweerasinghe/OruthotaChalets/src/app/bookings/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/thilinaweerasinghe/OruthotaChalets/src/app/bookings/page.tsx","default")},50994:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>O});var s=r(60687),a=r(30474),i=r(27102),n=r(5672),l=r(29523),o=r(67574),d=r(43210),c=r(75535),u=r(85814),m=r.n(u),x=r(16189),p=r(11392);function h(e,t){let r,s,a=t?.additionalDigits??2,i=function(e){let t,r={},s=e.split(f.dateTimeDelimiter);if(s.length>2)return r;if(/:/.test(s[0])?t=s[0]:(r.date=s[0],t=s[1],f.timeZoneDelimiter.test(r.date)&&(r.date=e.split(f.timeZoneDelimiter)[0],t=e.substr(r.date.length,e.length))),t){let e=f.timezone.exec(t);e?(r.time=t.replace(e[1],""),r.timezone=e[1]):r.time=t}return r}(e);if(i.date){let e=function(e,t){let r=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=e.match(r);if(!s)return{year:NaN,restDateString:""};let a=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:null===i?a:100*i,restDateString:e.slice((s[1]||s[2]).length)}}(i.date,a);r=function(e,t){var r,s,a,i,n,l,o,d;if(null===t)return new Date(NaN);let c=e.match(g);if(!c)return new Date(NaN);let u=!!c[4],m=N(c[1]),x=N(c[2])-1,p=N(c[3]),h=N(c[4]),f=N(c[5])-1;if(u){return(r=0,s=h,a=f,s>=1&&s<=53&&a>=0&&a<=6)?function(e,t,r){let s=new Date(0);s.setUTCFullYear(e,0,4);let a=s.getUTCDay()||7;return s.setUTCDate(s.getUTCDate()+((t-1)*7+r+1-a)),s}(t,h,f):new Date(NaN)}{let e=new Date(0);return(i=t,n=x,l=p,n>=0&&n<=11&&l>=1&&l<=(y[n]||(w(i)?29:28))&&(o=t,(d=m)>=1&&d<=(w(o)?366:365)))?(e.setUTCFullYear(t,x,Math.max(m,p)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);let n=r.getTime(),l=0;if(i.time&&isNaN(l=function(e){var t,r,s;let a=e.match(b);if(!a)return NaN;let i=j(a[1]),n=j(a[2]),l=j(a[3]);return(t=i,r=n,s=l,24===t?0===r&&0===s:s>=0&&s<60&&r>=0&&r<60&&t>=0&&t<25)?i*p.s0+n*p.Cg+1e3*l:NaN}(i.time)))return new Date(NaN);if(i.timezone){if(isNaN(s=function(e){var t,r;if("Z"===e)return 0;let s=e.match(v);if(!s)return 0;let a="+"===s[1]?-1:1,i=parseInt(s[2]),n=s[3]&&parseInt(s[3])||0;return(t=0,(r=n)>=0&&r<=59)?a*(i*p.s0+n*p.Cg):NaN}(i.timezone)))return new Date(NaN)}else{let e=new Date(n+l),t=new Date(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return new Date(n+l+s)}let f={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},g=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,b=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,v=/^([+-])(\d{2})(?::?(\d{2}))?$/;function N(e){return e?parseInt(e):1}function j(e){return e&&parseFloat(e.replace(",","."))||0}let y=[31,null,31,30,31,30,31,31,30,31,30,31];function w(e){return e%400==0||e%4==0&&e%100!=0}var D=r(47138),k=r(90327),C=r(89106),P=r(73437),A=r(24224),q=r(4780);let T=(0,A.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function U({className:e,variant:t,...r}){return(0,s.jsx)("div",{className:(0,q.cn)(T({variant:t}),e),...r})}var M=r(26622),I=r(40988),_=r(26373);function $(){let e=i.G.find(e=>"hero-estate"===e.id),t=(0,o.useFirestore)(),r=(0,x.useSearchParams)(),u=r.get("checkIn"),p=r.get("checkOut"),f=r.get("adults"),g=r.get("children"),b=(parseInt(f||"0")+parseInt(g||"0")).toString(),v=(0,d.useMemo)(()=>t?(0,c.rJ)(t,"rooms"):null,[t]),{data:N,isLoading:j}=(0,o.useCollection)(v),y=(0,d.useMemo)(()=>t?(0,c.rJ)(t,"reservations"):null,[t]),{data:w,isLoading:A}=(0,o.useCollection)(y),q=(0,d.useMemo)(()=>{if(A||!N||!u||!p)return N?.map(e=>({...e,isAvailable:!1,nextAvailableDates:[],bookedDates:[]}))||[];if(!w)return N.map(e=>({...e,isAvailable:!0,nextAvailableDates:[],bookedDates:[]}));let e=h(u),t=h(p);return N.map(r=>{let s=w.filter(e=>e.roomId===r.id&&"confirmed"===e.status).map(e=>({start:h(e.checkInDate+"T00:00:00Z"),end:h(e.checkOutDate+"T00:00:00Z")})).sort((e,t)=>e.start.getTime()-t.start.getTime()),a=s.some(r=>e<r.end&&r.start<t),i=s.flatMap(e=>(function(e,t){let r=(0,D.a)(e.start),s=(0,D.a)(e.end),a=+r>+s,i=a?+r:+s,n=a?s:r;n.setHours(0,0,0,0);let l=(void 0)??1;if(!l)return[];l<0&&(l=-l,a=!a);let o=[];for(;+n<=i;)o.push((0,D.a)(n)),n.setDate(n.getDate()+l),n.setHours(0,0,0,0);return a?o.reverse():o})({start:e.start,end:(0,k.f)(e.end,-1)}));if(!a)return{...r,isAvailable:!0,nextAvailableDates:[],bookedDates:i};let n=[],l=(0,k.f)(new Date,1);for(;n.length<7&&(s.some(e=>l>=e.start&&l<e.end)||n.push(new Date(l)),l=(0,k.f)(l,1),!((0,C.m)(l,new Date)>730)););return{...r,isAvailable:!1,nextAvailableDates:n,bookedDates:i}})},[N,w,u,p,A]),T=j||A;return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("section",{className:"relative h-[50vh] min-h-[400px] w-full",children:[e&&(0,s.jsx)(a.default,{src:e.imageUrl,alt:e.description,fill:!0,className:"object-cover",priority:!0,"data-ai-hint":e.imageHint}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40"}),(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center text-white z-10 w-full px-4 flex items-center justify-center",children:(0,s.jsx)("div",{className:"flex flex-col items-center justify-center",children:(0,s.jsx)("h1",{className:"font-headline text-5xl md:text-7xl tracking-wider font-normal text-white/90",children:"Available Rooms"})})})]}),(0,s.jsx)("div",{className:"bg-background",children:(0,s.jsx)("div",{className:"py-8",children:(0,s.jsx)(n.W,{})})}),u&&p&&(0,s.jsx)("div",{className:"py-4 bg-secondary text-center text-foreground",children:(0,s.jsxs)("p",{children:["Showing availability for: ",(0,s.jsx)("strong",{children:(0,P.GP)(h(u),"PPP")})," to ",(0,s.jsx)("strong",{children:(0,P.GP)(h(p),"PPP")})," for ",(0,s.jsx)("strong",{children:b})," guest(s)."]})}),(0,s.jsx)("section",{className:"py-20 bg-secondary",children:(0,s.jsx)("div",{className:"container mx-auto px-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-12",children:[T&&(0,s.jsx)("p",{className:"text-center",children:"Checking availability..."}),!T&&!q.length&&(0,s.jsxs)("div",{className:"text-center col-span-full bg-background p-12",children:[(0,s.jsx)("h3",{className:"font-headline text-2xl text-destructive",children:"No Rooms Found"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-4",children:"We couldn't find any rooms to check. Please check back later."})]}),q?.map(e=>{let t=`/booking?roomId=${e.id}&checkIn=${u||""}&checkOut=${p||""}&adults=${f||2}&children=${g||0}`;return(0,s.jsx)("div",{className:"bg-background overflow-hidden",children:(0,s.jsxs)("div",{className:"grid md:grid-cols-2 items-center",children:[(0,s.jsx)("div",{className:"relative h-80 md:h-full min-h-[300px]",children:e.imageUrl?(0,s.jsx)(a.default,{src:e.imageUrl,alt:e.title,fill:!0,className:"object-cover"}):(0,s.jsx)("div",{className:"h-full w-full bg-muted flex items-center justify-center text-muted-foreground",children:"No Image"})}),(0,s.jsxs)("div",{className:"p-8 text-center",children:[(0,s.jsx)("div",{className:"mb-4 min-h-[60px]",children:e.isAvailable?(0,s.jsx)(U,{variant:"default",className:"bg-green-600 hover:bg-green-700",children:"Available"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(U,{variant:"destructive",children:"Not Available"}),e.nextAvailableDates.length>0&&(0,s.jsxs)("div",{className:"text-sm text-muted-foreground mt-2",children:[(0,s.jsx)("p",{children:"Next available dates:"}),(0,s.jsx)("p",{className:"font-semibold text-primary text-xs",children:e.nextAvailableDates.map(e=>(0,P.GP)(e,"MMM dd")).join(", ")})]})]})}),(0,s.jsxs)("h3",{className:"font-headline text-3xl text-foreground relative inline-block",children:[e.title,(0,s.jsx)("div",{className:"absolute bottom-[-10px] left-1/2 -translate-x-1/2 w-1/4 border-b-2 border-primary"})]}),(0,s.jsx)("p",{className:"text-muted-foreground mt-8 text-sm leading-relaxed min-h-[120px] max-w-md mx-auto",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4 text-sm text-foreground my-8",children:[(0,s.jsxs)("span",{children:[e.roomCount," Rooms"]}),(0,s.jsx)("div",{className:"w-px h-4 bg-border"}),(0,s.jsx)("span",{children:e.view})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("span",{className:"font-bold text-lg text-primary",children:["$",e.pricePerNight]}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:" / night"})]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-center items-center",children:[(0,s.jsxs)(I.AM,{children:[(0,s.jsx)(I.Wv,{asChild:!0,children:(0,s.jsxs)(l.$,{variant:"outline",className:"text-foreground font-semibold tracking-wider hover:text-primary",children:[(0,s.jsx)(M.A,{className:"mr-2 h-4 w-4"}),"VIEW CALENDAR"]})}),(0,s.jsx)(I.hl,{className:"w-auto p-0",children:(0,s.jsx)(_.V,{mode:"multiple",min:1,selected:[],disabled:e.bookedDates,modifiers:{booked:e.bookedDates},modifiersClassNames:{booked:"day-booked",disabled:"day-booked"},defaultMonth:u?h(u):new Date})})]}),(0,s.jsx)(m(),{href:t,passHref:!0,children:(0,s.jsx)(l.$,{className:"bg-primary text-primary-foreground rounded-sm font-semibold tracking-wider hover:bg-primary/90",disabled:!e.isAvailable,children:"BOOK NOW"})})]})]})]})},e.id)})]})})})]})}function O(){return(0,s.jsx)(d.Suspense,{fallback:(0,s.jsx)("div",{className:"text-center p-8",children:"Loading..."}),children:(0,s.jsx)($,{})})}},53227:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=r(65239),a=r(48088),i=r(88170),n=r.n(i),l=r(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d={children:["",{children:["bookings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,42355)),"/Users/thilinaweerasinghe/OruthotaChalets/src/app/bookings/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/Users/thilinaweerasinghe/OruthotaChalets/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/thilinaweerasinghe/OruthotaChalets/src/app/bookings/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/bookings/page",pathname:"/bookings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},77089:(e,t,r)=>{Promise.resolve().then(r.bind(r,42355))},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,488,171,216,617,377],()=>r(53227));module.exports=s})();