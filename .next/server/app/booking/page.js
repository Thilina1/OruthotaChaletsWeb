(()=>{var e={};e.id=766,e.ids=[766],e.modules={2655:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var r=s(65239),a=s(48088),i=s(88170),n=s.n(i),l=s(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d={children:["",{children:["booking",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,64308)),"/Users/thilinaweerasinghe/OruthotaChalets/src/app/booking/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:"/manifest.webmanifest"}}]},{layout:[()=>Promise.resolve().then(s.bind(s,77002)),"/Users/thilinaweerasinghe/OruthotaChalets/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:"/manifest.webmanifest"}}]}.children,c=["/Users/thilinaweerasinghe/OruthotaChalets/src/app/booking/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/booking/page",pathname:"/booking",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16391:(e,t,s)=>{"use strict";s.d(t,{N:()=>r});let r=(0,s(65492).UU)("https://ysejulbuvunfhodersjr.supabase.co","sb_publishable_nn7GsENQXU_YmbYO7S8bUA_s8P4SVW5")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},26622:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(82614).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},27344:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var r=s(60687),a=s(43210),i=s(16189),n=s(30474),l=s(37074),o=s(90327),d=s(89106),c=s(73437),u=s(4780);let m=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,u.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));m.displayName="Card";let p=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,u.cn)("flex flex-col space-y-1.5 p-6",e),...t}));p.displayName="CardHeader";let h=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,u.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));h.displayName="CardTitle";let x=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,u.cn)("text-sm text-muted-foreground",e),...t}));x.displayName="CardDescription";let f=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,u.cn)("p-6 pt-0",e),...t}));f.displayName="CardContent";let g=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,u.cn)("flex items-center p-6 pt-0",e),...t}));g.displayName="CardFooter";var v=s(29523),b=s(89667),j=s(54300),N=s(34729),y=s(26622),w=s(29867),k=s(16391);function _(){let e=(0,i.useSearchParams)(),t=(0,i.useRouter)(),{toast:s}=(0,w.dj)(),[u,_]=(0,a.useState)(null);e.get("roomId");let P=(0,l.o)(new Date),[C,q]=(0,a.useState)(""),[M,R]=(0,a.useState)(""),[S,D]=(0,a.useState)(""),[F,A]=(0,a.useState)(""),[G,U]=(0,a.useState)(""),[I,J]=(0,a.useState)(""),[E,O]=(0,a.useState)(()=>{let t=e.get("checkIn");try{if(t&&new Date(t)>P)return new Date(t)}catch{}return(0,o.f)(P,1)}),[T,B]=(0,a.useState)(()=>{let t=e.get("checkOut"),s=e.get("checkIn"),r=s?new Date(s):(0,o.f)(P,1);try{if(t&&new Date(t)>r)return new Date(t)}catch{}return(0,o.f)(r,1)}),L=(0,a.useMemo)(()=>parseInt(e.get("adults")||"2"),[e]),$=(0,a.useMemo)(()=>parseInt(e.get("children")||"0"),[e]),z=(0,a.useMemo)(()=>L+$,[L,$]),Y=(0,a.useMemo)(()=>E&&T&&T>E?(0,d.m)(T,E):0,[E,T]),W=(0,a.useMemo)(()=>u&&Y>0?u.pricePerNight*Y:0,[u,Y]),X=async e=>{if(e.preventDefault(),!u||!E||!T)return void s({variant:"destructive",title:"Error",description:"Could not submit booking. Please try again later."});if(Y<=0)return void s({variant:"destructive",title:"Invalid Dates",description:"Check-out date must be after check-in date."});try{let{data:e,error:r}=await k.N.from("guests").upsert([{first_name:C,last_name:M,email:S,phone_number:F,id_card_number:G}],{onConflict:"email"}).select().single();if(r)throw r;let a={guest_id:e.id,room_id:u.id,room_title:u.title,guest_name:`${C} ${M}`,guest_email:S,check_in_date:(0,c.GP)(E,"yyyy-MM-dd"),check_out_date:(0,c.GP)(T,"yyyy-MM-dd"),number_of_guests:z,total_cost:W,status:"confirmed",special_requests:I,id_card_number:G,guest_phone:F},{error:i}=await k.N.from("reservations").insert([a]);if(i)throw i;s({title:"Booking Request Sent!",description:"We have received your request and will confirm shortly."}),t.push("/")}catch(e){console.error("Booking failed:",e),s({variant:"destructive",title:"Booking Failed",description:e.message})}};return u?u?(0,r.jsxs)("div",{className:"bg-secondary",children:[(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsxs)("div",{className:"container mx-auto py-20 px-4",children:[(0,r.jsx)("h1",{className:"font-headline text-4xl text-center text-foreground mb-12",children:"Confirm Your Booking"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)(m,{children:[(0,r.jsxs)(p,{children:[(0,r.jsx)("div",{className:"relative h-60 w-full mb-4",children:(0,r.jsx)(n.default,{src:u.imageUrl,alt:u.title,fill:!0,className:"object-cover rounded-t-lg"})}),(0,r.jsx)(h,{className:"font-headline text-2xl",children:u.title}),(0,r.jsx)(x,{children:u.description})]}),(0,r.jsxs)(f,{className:"space-y-4 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Price per night"}),(0,r.jsxs)("span",{className:"font-semibold",children:["$",u.pricePerNight.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Number of nights"}),(0,r.jsx)("span",{className:"font-semibold",children:Y>0?Y:"-"})]}),(0,r.jsx)("div",{className:"border-t my-2"}),(0,r.jsxs)("div",{className:"flex justify-between items-center text-lg",children:[(0,r.jsx)("span",{className:"font-bold text-foreground",children:"Total cost"}),(0,r.jsxs)("span",{className:"font-bold text-primary",children:["$",W.toFixed(2)]})]})]})]})}),(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsx)("form",{onSubmit:X,children:(0,r.jsxs)(m,{children:[(0,r.jsxs)(p,{children:[(0,r.jsx)(h,{children:"Guest Information"}),(0,r.jsx)(x,{children:"Please provide your details to complete the booking."})]}),(0,r.jsxs)(f,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"check-in",children:"Check-in Date"}),(0,r.jsxs)("div",{id:"check-in",className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background/50 px-3 py-2 text-sm",children:[(0,r.jsx)(y.A,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{children:E?(0,c.GP)(E,"PPP"):"N/A"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"check-out",children:"Check-out Date"}),(0,r.jsxs)("div",{id:"check-out",className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background/50 px-3 py-2 text-sm",children:[(0,r.jsx)(y.A,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{children:T?(0,c.GP)(T,"PPP"):"N/A"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"first-name",children:"First Name"}),(0,r.jsx)(b.p,{id:"first-name",value:C,onChange:e=>q(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"last-name",children:"Last Name"}),(0,r.jsx)(b.p,{id:"last-name",value:M,onChange:e=>R(e.target.value),required:!0})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"email",children:"Email"}),(0,r.jsx)(b.p,{id:"email",type:"email",value:S,onChange:e=>D(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"phone",children:"Phone Number"}),(0,r.jsx)(b.p,{id:"phone",type:"tel",value:F,onChange:e=>A(e.target.value),required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"id-card-number",children:"NIC / Passport Number"}),(0,r.jsx)(b.p,{id:"id-card-number",value:G,onChange:e=>U(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.J,{htmlFor:"special-requests",children:"Special Requests"}),(0,r.jsx)(N.T,{id:"special-requests",value:I,onChange:e=>J(e.target.value),placeholder:"Any special requirements? Let us know."})]})]}),(0,r.jsx)(g,{children:(0,r.jsx)(v.$,{type:"submit",className:"w-full",disabled:Y<=0,children:"Request to Book"})})]})})})]})]})]}):(0,r.jsx)("div",{className:"container mx-auto p-4 text-center text-destructive",children:"Room not found. Please select a valid room."}):(0,r.jsx)("div",{className:"container mx-auto p-4 text-center",children:"Loading..."})}function P(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"container mx-auto p-4 text-center",children:"Loading booking details..."}),children:(0,r.jsx)(_,{})})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34729:(e,t,s)=>{"use strict";s.d(t,{T:()=>n});var r=s(60687),a=s(43210),i=s(4780);let n=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...t}));n.displayName="Textarea"},48096:(e,t,s)=>{Promise.resolve().then(s.bind(s,27344))},54300:(e,t,s)=>{"use strict";s.d(t,{J:()=>c});var r=s(60687),a=s(43210),i=s(3416),n=a.forwardRef((e,t)=>(0,r.jsx)(i.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var l=s(24224),o=s(4780);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)(n,{ref:s,className:(0,o.cn)(d(),e),...t}));c.displayName=n.displayName},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64308:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/thilinaweerasinghe/OruthotaChalets/src/app/booking/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/thilinaweerasinghe/OruthotaChalets/src/app/booking/page.tsx","default")},70440:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(31658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},79551:e=>{"use strict";e.exports=require("url")},84544:(e,t,s)=>{Promise.resolve().then(s.bind(s,64308))},90327:(e,t,s)=>{"use strict";s.d(t,{f:()=>i});var r=s(47138),a=s(35780);function i(e,t){let s=(0,r.a)(e);return isNaN(t)?(0,a.w)(e,NaN):(t&&s.setDate(s.getDate()+t),s)}}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447,85,515,437,111,964],()=>s(2655));module.exports=r})();