(()=>{var e={};e.id=766,e.ids=[766],e.modules={2655:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var r=s(65239),a=s(48088),i=s(88170),n=s.n(i),o=s(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let d={children:["",{children:["booking",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,64308)),"/Users/thilinaweerasinghe/OruthotaChalets/src/app/booking/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,94431)),"/Users/thilinaweerasinghe/OruthotaChalets/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/thilinaweerasinghe/OruthotaChalets/src/app/booking/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/booking/page",pathname:"/booking",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13352:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>R});var r=s(60687),a=s(43210),i=s(16189),n=s(30474),o=s(67574),l=s(75535),d=s(37074),c=s(90327),u=s(89106),p=s(73437),m=s(4780);let x=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,m.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));x.displayName="Card";let h=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,m.cn)("flex flex-col space-y-1.5 p-6",e),...t}));h.displayName="CardHeader";let f=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,m.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));f.displayName="CardTitle";let g=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,m.cn)("text-sm text-muted-foreground",e),...t}));g.displayName="CardDescription";let v=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,m.cn)("p-6 pt-0",e),...t}));v.displayName="CardContent";let j=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,m.cn)("flex items-center p-6 pt-0",e),...t}));j.displayName="CardFooter";var b=s(29523),N=s(89667),y=s(3416),w=a.forwardRef((e,t)=>(0,r.jsx)(y.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));w.displayName="Label";let k=(0,s(24224).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),P=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)(w,{ref:s,className:(0,m.cn)(k(),e),...t}));P.displayName=w.displayName;let q=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("textarea",{className:(0,m.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...t}));q.displayName="Textarea";var C=s(26622),D=s(29867);function M(){let e=(0,i.useSearchParams)(),t=(0,i.useRouter)(),s=(0,o.useFirestore)();(0,o.useAuth)();let{user:m,isUserLoading:y}=(0,o.useUser)(),{toast:w}=(0,D.dj)(),k=e.get("roomId"),M=(0,d.o)(new Date),[R,F]=(0,a.useState)(""),[S,_]=(0,a.useState)(""),[A,G]=(0,a.useState)(""),[I,O]=(0,a.useState)(""),[E,U]=(0,a.useState)(""),[B,L]=(0,a.useState)(""),[T,$]=(0,a.useState)(()=>{let t=e.get("checkIn");try{if(t&&new Date(t)>M)return new Date(t)}catch{}return(0,c.f)(M,1)}),[z,H]=(0,a.useState)(()=>{let t=e.get("checkOut"),s=e.get("checkIn"),r=s?new Date(s):(0,c.f)(M,1);try{if(t&&new Date(t)>r)return new Date(t)}catch{}return(0,c.f)(r,1)}),J=(0,a.useMemo)(()=>parseInt(e.get("adults")||"2"),[e]),K=(0,a.useMemo)(()=>parseInt(e.get("children")||"0"),[e]),W=(0,a.useMemo)(()=>J+K,[J,K]),X=(0,a.useMemo)(()=>s&&k?(0,l.H9)(s,"rooms",k):null,[s,k]),{data:Y,isLoading:Q}=(0,o.useDoc)(X),V=(0,a.useMemo)(()=>T&&z&&z>T?(0,u.m)(z,T):0,[T,z]),Z=(0,a.useMemo)(()=>Y&&V>0?Y.pricePerNight*V:0,[Y,V]),ee=async e=>{if(e.preventDefault(),!m||!s||!Y||!T||!z)return void w({variant:"destructive",title:"Error",description:"Could not submit booking. Please try again later."});if(V<=0)return void w({variant:"destructive",title:"Invalid Dates",description:"Check-out date must be after check-in date."});try{let e=(0,l.H9)(s,"guests",m.uid),r={id:m.uid,firstName:R,lastName:S,email:A,phoneNumber:I,idCardNumber:E};await (0,l.BN)(e,r,{merge:!0});let a={...{guestId:m.uid,roomId:Y.id,roomTitle:Y.title,guestName:`${R} ${S}`,guestEmail:A,checkInDate:(0,p.GP)(T,"yyyy-MM-dd"),checkOutDate:(0,p.GP)(z,"yyyy-MM-dd"),numberOfGuests:W,totalCost:Z,status:"confirmed",specialRequests:B,idCardNumber:E,guestPhone:I},bookingDate:(0,l.O5)()};await (0,l.gS)((0,l.rJ)(s,"reservations"),a),w({title:"Booking Request Sent!",description:"We have received your request and will confirm shortly."}),t.push("/")}catch(e){console.error("Booking failed:",e),w({variant:"destructive",title:"Booking Failed",description:e.message})}};return Q||y?(0,r.jsx)("div",{className:"container mx-auto p-4 text-center",children:"Loading..."}):Y?(0,r.jsxs)("div",{className:"bg-secondary",children:[(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsxs)("div",{className:"container mx-auto py-20 px-4",children:[(0,r.jsx)("h1",{className:"font-headline text-4xl text-center text-foreground mb-12",children:"Confirm Your Booking"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)(x,{children:[(0,r.jsxs)(h,{children:[(0,r.jsx)("div",{className:"relative h-60 w-full mb-4",children:(0,r.jsx)(n.default,{src:Y.imageUrl,alt:Y.title,fill:!0,className:"object-cover rounded-t-lg"})}),(0,r.jsx)(f,{className:"font-headline text-2xl",children:Y.title}),(0,r.jsx)(g,{children:Y.description})]}),(0,r.jsxs)(v,{className:"space-y-4 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Price per night"}),(0,r.jsxs)("span",{className:"font-semibold",children:["$",Y.pricePerNight.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Number of nights"}),(0,r.jsx)("span",{className:"font-semibold",children:V>0?V:"-"})]}),(0,r.jsx)("div",{className:"border-t my-2"}),(0,r.jsxs)("div",{className:"flex justify-between items-center text-lg",children:[(0,r.jsx)("span",{className:"font-bold text-foreground",children:"Total cost"}),(0,r.jsxs)("span",{className:"font-bold text-primary",children:["$",Z.toFixed(2)]})]})]})]})}),(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsx)("form",{onSubmit:ee,children:(0,r.jsxs)(x,{children:[(0,r.jsxs)(h,{children:[(0,r.jsx)(f,{children:"Guest Information"}),(0,r.jsx)(g,{children:"Please provide your details to complete the booking."})]}),(0,r.jsxs)(v,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(P,{htmlFor:"check-in",children:"Check-in Date"}),(0,r.jsxs)("div",{id:"check-in",className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background/50 px-3 py-2 text-sm",children:[(0,r.jsx)(C.A,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{children:T?(0,p.GP)(T,"PPP"):"N/A"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(P,{htmlFor:"check-out",children:"Check-out Date"}),(0,r.jsxs)("div",{id:"check-out",className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background/50 px-3 py-2 text-sm",children:[(0,r.jsx)(C.A,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{children:z?(0,p.GP)(z,"PPP"):"N/A"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(P,{htmlFor:"first-name",children:"First Name"}),(0,r.jsx)(N.p,{id:"first-name",value:R,onChange:e=>F(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(P,{htmlFor:"last-name",children:"Last Name"}),(0,r.jsx)(N.p,{id:"last-name",value:S,onChange:e=>_(e.target.value),required:!0})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(P,{htmlFor:"email",children:"Email"}),(0,r.jsx)(N.p,{id:"email",type:"email",value:A,onChange:e=>G(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(P,{htmlFor:"phone",children:"Phone Number"}),(0,r.jsx)(N.p,{id:"phone",type:"tel",value:I,onChange:e=>O(e.target.value),required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(P,{htmlFor:"id-card-number",children:"NIC / Passport Number"}),(0,r.jsx)(N.p,{id:"id-card-number",value:E,onChange:e=>U(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(P,{htmlFor:"special-requests",children:"Special Requests"}),(0,r.jsx)(q,{id:"special-requests",value:B,onChange:e=>L(e.target.value),placeholder:"Any special requirements? Let us know."})]})]}),(0,r.jsx)(j,{children:(0,r.jsx)(b.$,{type:"submit",className:"w-full",disabled:y||!m||V<=0,children:"Request to Book"})})]})})})]})]})]}):(0,r.jsx)("div",{className:"container mx-auto p-4 text-center text-destructive",children:"Room not found. Please select a valid room."})}function R(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"container mx-auto p-4 text-center",children:"Loading booking details..."}),children:(0,r.jsx)(M,{})})}s(32258)},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},26622:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(82614).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37366:e=>{"use strict";e.exports=require("dns")},48096:(e,t,s)=>{Promise.resolve().then(s.bind(s,13352))},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64308:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/thilinaweerasinghe/OruthotaChalets/src/app/booking/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/thilinaweerasinghe/OruthotaChalets/src/app/booking/page.tsx","default")},70440:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(31658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},84544:(e,t,s)=>{Promise.resolve().then(s.bind(s,64308))},90327:(e,t,s)=>{"use strict";s.d(t,{f:()=>i});var r=s(47138),a=s(35780);function i(e,t){let s=(0,r.a)(e);return isNaN(t)?(0,a.w)(e,NaN):(t&&s.setDate(s.getDate()+t),s)}},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447,488,171,617],()=>s(2655));module.exports=r})();